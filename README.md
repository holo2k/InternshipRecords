# InternshipRecords — Учёт стажёров

Веб-приложение для учёта стажёров с CRUD для стажёров / направлений / проектов, фильтрами, поиском, пагинацией и возможностью привязывать стажёров к проектам/направлениям. UI — Blazor Web Assembly, backend — ASP.NET Core. Архитектура в слоях + CQRS (MediatR). Включена валидация через FluentValidation. Есть SignalR для real-time обновлений.

---

## Структура репозитория (важные папки)

```
C:.
└── src
    ├── client/InternshipRecords.Client       # Blazor фронтенд
    ├── server/InternshipRecords.Web          # Web API + Controllers + SignalR Hub
    ├── server/InternshipRecords.Application  # CQRS (MediatR) — команды/запросы/обработчики
    ├── server/InternshipRecords.Infrastructure# EF Core, репозитории, миграции
    ├── server/InternshipRecords.Domain      # Сущности
    └── Shared                               # DTO/Request/Response модели, общие enum'ы
```

---

## Технологии

* .NET 9
* ASP.NET Core Web API
* EF Core + Postgres
* Blazor WebAssembly
* MediatR
* FluentValidation
* SignalR
* docker-compose
* AutoMapper
* Swagger

---

## Выполненные задачи

1. **Добавление стажёра**
   * Форма с полями: Имя, Фамилия, Пол, Email (уникальный), Телефон (опционально, если указан — должен начинаться с `+7` и быть уникальным), Дата рождения, Направление, Проект.
   Можно выбрать существующее направление/проект или создать новое прямо из формы (выпадающий список содержит `+ Новое направление / + Новый проект`).

2. **Списки направлений и проектов**

   * Таб/переключатель между направлениями и проектами.
   * Для каждого элемента показывается количество стажёров и можно просмотреть список стажёров.
   * Поиск, сортировка (по названию и по количеству стажёров), пагинация.
   * CRUD операций для направлений/проектов. При наличии связанных стажёров удаление запрещено (с сообщением пользователю).
   * При создании / редактировании направления/проекта есть multi-select для прикрепления существующих стажёров.

3. **Список стажёров**

   * Карточки со стажёрами.
   * Фильтрация по направлению и проекту.
   * Редактирование стажёра.
   * При добавлении/редактировании/удалении другим пользователем список обновляется без перезагрузки.

---

## Архитектура

* **Слои**: `Web` (контроллеры, SignalR), `Application` (CQRS: команды/запросы, обработчики), `Infrastructure` (EF Core, репозитории), `Domain` (сущности), `Client` (Blazor).
* **CQRS + MediatR**: запросы/команды (например `AddInternCommand`, `GetInternsQuery`) и их обработчики разделяют ответственность.
* **FluentValidation**: валидаторы команд (например `AddInternCommandValidator`) подключены в pipeline и бросают `ValidationException` при ошибках.
* **PipelineBehavior** в Web проекции ловит и агрегирует ошибки валидации до вызова обработчика.
* **ControllerExtensions.FromException** — единый формат ответа на ошибки
---

## Запуск
 * Перейти в папку Docker
 * Написать в консоли `docker-compose up -d --build`
 * Swagger - ```http://localhost:5001/```
 * Frontend - ```http://localhost:5000/```

## Как работать с UI

* **Прикрепление стажёров к направлению/проекту (multi-select)**
  В формах создания/редактирования направлений/проектов используется `<select multiple>`. Чтобы выбрать несколько стажёров в браузере удерживайте `Ctrl` и кликайте по элементам.
* **Создание нового направления/проекта из формы добавления стажёра**
  В выпадающем списке выберите `+ Новое направление` / `+ Новый проект`, заполните поля — при сохранении приложение попытается создать сущность и затем привязать к ней стажёра.
* **Валидация формы стажёра**
  * Email: обязательный, валидный и уникальный.
  * Телефон: опционально; если заполнен — должен начинаться с `+7`, быть валидным и уникальным.
  * Дата рождения: стажёр должен быть старше 16 лет.
* **Удаление направлений / проектов**
  * Если есть связанные стажёры — API запретит удаление и вернёт понятную ошибку. UI показывает сообщение пользователю.
---
## Контакты

* TG: [holo21k](https://t.me/holo21k)
* Email: [nneketaa@yandex.ru](mailto:nneketaa@yandex.ru)
